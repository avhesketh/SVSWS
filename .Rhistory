bal_fig <- ggplot(aes(x = trt, y = mean_abund, fill = consecutive), data = bal_summ) +
geom_bar(stat = "identity", position = "dodge") +
geom_errorbar(aes(ymax = mean_abund + se_abund, ymin = mean_abund - se_abund),
position = position_dodge(width = 0.9),
width = 0.5) +
facet_wrap(~size) +
theme_classic() +
ggtitle("Size class") +
ylab("Abundance") +
xlab("Temperature treatment") +
theme(plot.title = element_text(hjust = 0.5, size = 16)) +
theme(axis.title = element_text(size = 16)) +
theme(axis.text = element_text(size = 12)) +
theme(strip.text = element_text(size = 14)) +
theme(legend.title = element_text(size = 14)) +
theme(legend.text = element_text(size = 12)) +
scale_fill_manual(values = c("grey30", "grey70"))
bal_fig
chtham_fig <- ggplot(aes(x = trt, y = mean_abund, fill = consecutive), data = chtham_summ) +
geom_bar(stat = "identity", position = "dodge") +
geom_errorbar(aes(ymax = mean_abund + se_abund, ymin = mean_abund - se_abund),
position = position_dodge(width = 0.9),
width = 0.5) +
facet_wrap(~size) +
theme_classic() +
ggtitle("Size class") +
ylab("Abundance") +
xlab("Temperature treatment") +
theme(plot.title = element_text(hjust = 0.5, size = 16)) +
theme(axis.title = element_text(size = 16)) +
theme(axis.text = element_text(size = 12)) +
theme(strip.text = element_text(size = 14)) +
theme(legend.title = element_text(size = 14)) +
theme(legend.text = element_text(size = 12)) +
scale_fill_manual(values = c("grey30", "grey70"))
chtham_fig
se <- function(x) {
sd(x)/sqrt(length(x))
}
library(tidyverse)
library(glmmTMB)
library(car)
library(DHARMa)
surveys <- read_csv("surveys.csv")
barnacles_jul20 <- surveys %>%
filter(date == "2020-07-09")
barnacles_jul20 <- surveys %>%
filter(date == "2020-07-09") %>%
filter(species == "balanus" | species == "chthamalus")
plot(count ~ species)
head(barnaces_jul20)
head(barnacles_jul20)
glimpse(barnacles_jul20)
surveys <- read.csv("surveys.csv")
barnacles_jul20 <- surveys %>%
filter(date == "2020-07-09") %>%
filter(species == "balanus" | species == "chthamalus")
glimpse(barnacles_jul20)
surveys <- read.csv("surveys.csv")
glimpse(surveys)
barnacles_jul20 <- surveys %>%
filter(date == "20-07-09") %>%
filter(species == "balanus" | species == "chthamalus")
glimpse(barnacles_jul20)
barnacles_jul20 <- surveys %>%
filter(date == "20-07-09") %>%
filter(species == "balanus" | species == "chthamalus") %>%
select(-7, -8)
glimpse(barnacles_jul20)
barnacles_jul20 <- surveys %>%
filter(date == "20-07-09") %>%
filter(species == "balanus" | species == "chthamalus") %>%
select(-6, -7, -8)
glimpse(barnacles_jul20)
bal_jul20 <- barnacles_jul20 %>%
filter(species == "balanus")
chtham_jul20 <- chthamalus_jul20 %>%
filter(species == "chthamalus")
surveys <- read.csv("barnacle_recruitment_jul.csv")
barn_jul <- read.csv("barnacle_recruitment_jul.csv")
barn_jul_summ <- barn_jul %>%
group_by(trt, size, species, consecutive) %>%
summarize(mean_count = mean(count), se_count = se(count))
bal_fig <- ggplot(aes(x = trt, y = mean_abund, fill = consecutive), data = bal_summ) +
geom_bar(stat = "identity", position = "dodge") +
geom_errorbar(aes(ymax = mean_abund + se_abund, ymin = mean_abund - se_abund),
position = position_dodge(width = 0.9),
width = 0.5) +
facet_wrap(~size, species) +
theme_classic() +
ggtitle("Size class") +
ylab("Abundance") +
xlab("Temperature treatment") +
theme(plot.title = element_text(hjust = 0.5, size = 16)) +
theme(axis.title = element_text(size = 16)) +
theme(axis.text = element_text(size = 12)) +
theme(strip.text = element_text(size = 14)) +
theme(legend.title = element_text(size = 14)) +
theme(legend.text = element_text(size = 12)) +
scale_fill_manual(values = c("grey30", "grey70"))
bal_fig
bal_summ <- barn_jul_summ %>%
filter(species == "balanus")
bal_fig <- ggplot(aes(x = trt, y = mean_abund, fill = consecutive), data = bal_summ) +
geom_bar(stat = "identity", position = "dodge") +
geom_errorbar(aes(ymax = mean_abund + se_abund, ymin = mean_abund - se_abund),
position = position_dodge(width = 0.9),
width = 0.5) +
facet_wrap(~size) +
theme_classic() +
ggtitle("Size class") +
ylab("Abundance") +
xlab("Temperature treatment") +
theme(plot.title = element_text(hjust = 0.5, size = 16)) +
theme(axis.title = element_text(size = 16)) +
theme(axis.text = element_text(size = 12)) +
theme(strip.text = element_text(size = 14)) +
theme(legend.title = element_text(size = 14)) +
theme(legend.text = element_text(size = 12)) +
scale_fill_manual(values = c("grey30", "grey70"))
bal_fig
bal_fig <- ggplot(aes(x = trt, y = mean_count, fill = consecutive), data = bal_summ) +
geom_bar(stat = "identity", position = "dodge") +
geom_errorbar(aes(ymax = mean_count + se_count, ymin = mean_count - se_count),
position = position_dodge(width = 0.9),
width = 0.5) +
facet_wrap(~size) +
theme_classic() +
ggtitle("Size class") +
ylab("Abundance") +
xlab("Temperature treatment") +
theme(plot.title = element_text(hjust = 0.5, size = 16)) +
theme(axis.title = element_text(size = 16)) +
theme(axis.text = element_text(size = 12)) +
theme(strip.text = element_text(size = 14)) +
theme(legend.title = element_text(size = 14)) +
theme(legend.text = element_text(size = 12)) +
scale_fill_manual(values = c("grey30", "grey70"))
bal_fig
chtham_summ <- barn_jul_summ %>%
filter(species == "chthamalus")
bal_fig <- ggplot(aes(x = trt, y = mean_count, fill = consecutive), data = chtham_summ) +
geom_bar(stat = "identity", position = "dodge") +
geom_errorbar(aes(ymax = mean_count + se_count, ymin = mean_count - se_count),
position = position_dodge(width = 0.9),
width = 0.5) +
facet_wrap(~size) +
theme_classic() +
ggtitle("Size class") +
ylab("Abundance") +
xlab("Temperature treatment") +
theme(plot.title = element_text(hjust = 0.5, size = 16)) +
theme(axis.title = element_text(size = 16)) +
theme(axis.text = element_text(size = 12)) +
theme(strip.text = element_text(size = 14)) +
theme(legend.title = element_text(size = 14)) +
theme(legend.text = element_text(size = 12)) +
scale_fill_manual(values = c("grey30", "grey70"))
chtham_fig <- ggplot(aes(x = trt, y = mean_count, fill = consecutive), data = chtham_summ) +
geom_bar(stat = "identity", position = "dodge") +
geom_errorbar(aes(ymax = mean_count + se_count, ymin = mean_count - se_count),
position = position_dodge(width = 0.9),
width = 0.5) +
facet_wrap(~size) +
theme_classic() +
ggtitle("Size class") +
ylab("Abundance") +
xlab("Temperature treatment") +
theme(plot.title = element_text(hjust = 0.5, size = 16)) +
theme(axis.title = element_text(size = 16)) +
theme(axis.text = element_text(size = 12)) +
theme(strip.text = element_text(size = 14)) +
theme(legend.title = element_text(size = 14)) +
theme(legend.text = element_text(size = 12)) +
scale_fill_manual(values = c("grey30", "grey70"))
chtham_fig
barn_jul_summ <- barn_jul %>%
group_by(trt, species, consecutive) %>%
summarize(mean_count = mean(count), se_count = se(count))
bal_summ <- barn_jul_summ %>%
filter(species == "balanus")
chtham_summ <- barn_jul_summ %>%
filter(species == "chthamalus")
bal_fig <- ggplot(aes(x = trt, y = mean_count, fill = consecutive), data = barn_jul_summ) +
geom_bar(stat = "identity", position = "dodge") +
geom_errorbar(aes(ymax = mean_count + se_count, ymin = mean_count - se_count),
position = position_dodge(width = 0.9),
width = 0.5) +
facet_wrap(~species) +
theme_classic() +
ggtitle("Size class") +
ylab("Abundance") +
xlab("Temperature treatment") +
theme(plot.title = element_text(hjust = 0.5, size = 16)) +
theme(axis.title = element_text(size = 16)) +
theme(axis.text = element_text(size = 12)) +
theme(strip.text = element_text(size = 14)) +
theme(legend.title = element_text(size = 14)) +
theme(legend.text = element_text(size = 12)) +
scale_fill_manual(values = c("grey30", "grey70"))
bal_fig
bal_summ <- barn_jul %>%
filter(species == "balanus")
chtham_summ <- barn_jul %>%
filter(species == "chthamalus")
bal_jul_summ <- bal_summ %>%
group_by(trt, size, species, consecutive) %>%
summarize(mean_count = mean(count), se_count = se(count))
chtham_jul_summ <- chtham_summ %>%
group_by(trt, size, species, consecutive) %>%
summarize(mean_count = mean(count), se_count = se(count))
hist(bal_summ$count)
hist(bal_summ$count, breaks = 100)
bal.jul.1 <- glmmTMB(count ~ trt*consecutive*size + (1|block),
family = nbinom1())
bal.jul.1 <- glmmTMB(count ~ trt*consecutive*size + (1|block),
family = nbinom1(),
family = bal_summ)
bal.jul.1 <- glmmTMB(count ~ trt*consecutive*size + (1|block),
family = nbinom1(),
data = bal_summ)
plotResiduals(bal.jul.1)
plot(simulateResiduals(bal.jul.1))
summary(bal.jul.1)
Anova(bal.jul.1)
drop1(bal.jul.1, test = "Chisq")
bal.jul.2 <- update(bal.jul.1, ~. -trt:consecutive:size)
drop1(bal.jul.2, test = "Chisq")
bal.jul.3 <- update(bal.jul.2, ~. -consecutive:size)
Anova(bal.jul.3)
chtham.jul.1 <- glmmTMB(count ~ trt*consecutive*size + (1|block),
family = nbinom1(),
data = chtham_summ)
summary(chtham.jul.1)
drop1(chtham.jul.1, test = "Chisq")
chtham.jul.2 <- update(chtham.jul.1, ~. -trt:consecutive:size)
drop1(chtham.jul.2, test = "Chisq")
chtham.jul.2 <- update(chtham.jul.2, ~. -trt:consecutive)
drop1(chtham.jul.3, test = "Chisq")
chtham.jul.2 <- update(chtham.jul.1, ~. -trt:consecutive:size)
chtham.jul.3 <- update(chtham.jul.2, ~. -trt:consecutive)
drop1(chtham.jul.3, test = "Chisq")
chtham.jul.3 <- update(chtham.jul.3, ~. - trt:size)
chtham.jul.3 <- update(chtham.jul.2, ~. -trt:consecutive)
chtham.jul.4 <- update(chtham.jul.3, ~. - trt:size)
drop1(chtham.jul.4, test = "Chisq")
chtham.jul.5 <- update(chtham.jul.4, ~. -consecutive:size)
drop1(chtham.jul.5, test = "Chisq")
plot(simulateResiduals(chtham.jul.5))
Anova(chtham.jul.5)
survey_july <- read_csv("surveys.csv") %>%
filter(date > "20-07-01")
glimpse(survey_july)
survey_july <- read_csv("surveys.csv") %>%
filter(date > "20-07-01") %>%
select(-7,-8)
barn_jul <- read.csv("barnacle_recruitment_jul.csv")
glimpse(barn_jul)
barn_jul_trt <- barn_jul %>%
select(-5,-6,-7)
survey_july <- survey_july %>%
full_join(barn_jul_trt)
glimpse(survey_july)
spread_july <- spread(survey_july, key = species, value = count)
glimpse(spread_july)
glimpse(survey_july)
barn_jul_trt <- barn_jul %>%
select(-1, -5,-6,-7)
survey_july <- survey_july %>%
full_join(barn_jul_trt)
glimpse(survey_july)
survey_july <- read_csv("surveys.csv") %>%
filter(date > "20-07-01") %>%
select(-7,-8)
glimpse(survey_july)
survey_july <- read_csv("surveys.csv") %>%
filter(date > "20-07-01") %>%
select(-1, -6, -7,-8)
glimpse(survey_july)
survey_july <- survey_july %>%
full_join(barn_jul_trt)
glimpse(survey_july)
glimpse(barn_jul_trt)
barn_jul <- read.csv("barnacle_recruitment_jul.csv")
barn_jul_trt <- barn_jul %>%
select(-5,-6,-7)
glimpse(barn_jul_trt)
survey_july <- survey_july %>%
full_join(barn_jul_trt)
survey_july <- read_csv("surveys.csv") %>%
filter(date > "20-07-01") %>%
select(-1, -6, -7,-8)
barn_jul_trt <- barn_jul %>%
select(-5,-6,-7) %>%
rename(tile = "number")
barn_jul_trt <- barn_jul %>%
select(-5,-6,-7) %>%
rename(number = "tile")
survey_july <- survey_july %>%
full_join(barn_jul_trt)
spread_july <- spread(survey_july, key = species, value = count)
glimpse(survey_july)
survey_july <- read_csv("surveys.csv") %>%
filter(date > "20-07-01") %>%
select(-1, -6, -7,-8)
survey_july <- survey_july %>%
full_join(barn_jul_trt) %>%
unique()
spread_july <- spread(survey_july, key = species, value = count)
glimpse(spread_juy)
glimpse(spread_july)
survey_july <- survey_july %>%
full_join(barn_jul_trt) %>%
unique() %>%
mutate(ifelse(count = NA, 0, count))
survey_july <- read_csv("surveys.csv") %>%
filter(date > "20-07-01") %>%
select(-1, -6, -7,-8)
survey_july <- survey_july %>%
full_join(barn_jul_trt) %>%
unique() %>%
mutate(ifelse(count == NA, 0, count))
min(survey_july$count)
survey_july <- read_csv("surveys.csv") %>%
filter(date > "20-07-01") %>%
select(-1, -6, -7,-8)
survey_july <- survey_july %>%
full_join(barn_jul_trt) %>%
unique() %>%
mutate(ifelse(count = "NA", 0, count))
survey_july <- survey_july %>%
full_join(barn_jul_trt) %>%
unique() %>%
mutate(ifelse(count == "NA", 0, count))
glimpse(survey_july)
?ifelse
survey_july <- read_csv("surveys.csv") %>%
filter(date > "20-07-01") %>%
select(-1, -6, -7,-8)
survey_july <- survey_july %>%
full_join(barn_jul_trt) %>%
unique() %>%
mutate(if_else(count == "NA", 0, count))
glimpse(survey_july)
?if_else
survey_july <- read_csv("surveys.csv") %>%
filter(date > "20-07-01") %>%
select(-1, -6, -7,-8)
survey_july <- survey_july %>%
full_join(barn_jul_trt) %>%
unique() %>%
mutate(count = if_else(count == "NA", 0, count))
glimpse(survey_july)
spread_july <- spread(survey_july, key = species, value = count)
glimpse(spread_july)
spread_july <- spread(survey_july, key = species, value = count) %>%
select(-7, -9, -11)
glimpse(spread_july)
library(vegan)
install.packages("vegan")
library(vegan)
diversity(spread_july, index = "shannon")
survey_july <- read_csv("surveys.csv") %>%
filter(date > "20-07-01") %>%
select(-1, -6, -7,-8) %>%
mutate(count = as.numeric(count))
survey_july <- survey_july %>%
full_join(barn_jul_trt) %>%
unique() %>%
mutate(count = if_else(count == "NA", 0, count))
spread_july <- spread(survey_july, key = species, value = count) %>%
select(-7, -9, -11)
diversity(spread_july, index = "shannon")
spread_july[,1]
glimpse(spread_july)
spread_july_data <- spread_july[,4:8]
View(spread_july_data)
spread_july_data <- spread_july[,5:8]
diversity(spread_july_data, index = "shannon")
View(spread_july)
survey_july <- read_csv("surveys.csv") %>%
filter(date > "20-07-01") %>%
select(-1, -6, -7,-8) %>%
mutate(count = as.numeric(count)) %>%
mutate(count = if_else(count == "NA", 0, count))
View(survey_july)
spread_july <- spread(survey_july, key = species, value = count) %>%
select(-7, -9, -11) %>%
mutate(mytilus = if_else(mytilus == "NA", 0, mytilus))
survey_july <- survey_july %>%
full_join(barn_jul_trt) %>%
unique()
spread_july <- spread(survey_july, key = species, value = count) %>%
select(-7, -9, -11) %>%
mutate(mytilus = if_else(mytilus == "NA", 0, mytilus))
spread_july <- spread(survey_july, key = species, value = count) %>%
select(-7, -9, -11) %>%
mutate(mytilus = if_else(mytilus == NA, 0, mytilus))
spread_july <- spread(survey_july, key = species, value = count) %>%
select(-7, -9, -11) %>%
mutate(mytilus = if_else(mytilus == "NA", 0, mytilus))
glimpse(spread_july)
spread_july <- spread(survey_july, key = species, value = count) %>%
select(-7, -9, -11) %>%
mutate(mytilus = as.numeric(mytilus)) %>%
mutate(mytilus = if_else(mytilus == "NA", 0, mytilus))
glimpse(spread_july)
spread_july <- spread(survey_july, key = species, value = count) %>%
select(-7, -9, -11) %>%
mutate(mytilus = as.numeric(mytilus)) %>%
mutate(mytilus = if_else(mytilus = "NA", 0, mytilus))
spread_july <- spread(survey_july, key = species, value = count) %>%
select(-7, -9, -11) %>%
mutate(mytilus = if_else(mytilus == "NA", 0, mytilus))
spread_july <- spread(survey_july, key = species, value = count) %>%
select(-7, -9, -11) %>%
replace_na(mytilus, 0)
spread_july <- spread(survey_july, key = species, value = count) %>%
select(-7, -9, -11) %>%
mutate(mytilus = replace_na(mytilus, 0))
spread_july <- spread(survey_july, key = species, value = count) %>%
select(-7, -9, -11) %>%
mutate(mytilus = replace_na(mytilus, 0)) %>%
na.omit()
spread_july_data <- spread_july[,5:8]
diversity(spread_july_data, index = "shannon")
spread_july_div <- spread_july %>%
mutate(shannon = diversity(spread_july_data, index = "shannon"))
View(spread_july_div)
div_plot <- ggplot(aes(x = trt, colour = consecutive, y = shannon), data = spread_july_div) +
geom_bar(position = "dodge")
div_plot
div_plot <- ggplot(aes(x = trt, fill = consecutive, y = shannon), data = spread_july_div) +
geom_bar(position = "dodge")
div_plot
div_plot <- ggplot(aes(x = trt, fill = consecutive, y = shannon), data = spread_july_div) +
geom_bar(stat = "identity", position = "dodge")
div_plot
hist(div_plot$shannon, breaks=100)
hist(spread_july_div$shannon, breaks=100)
View(spread_july_div)
div.glmm.1 <- lmer(shannon ~ trt*consecutive + (1|block),
data = spread_july_div)
library(nlm3)
library(nlme)
library(lme4)
div.glmm.1 <- lmer(shannon ~ trt*consecutive + (1|block),
data = spread_july_div)
plot(div.glmm.1)
summary(div.glmm.1)
summary(div.glmm.1$lme)
anova(div.glmm.1)
Anova(div.glmm.1)
getwd()
setwd("./ibuttons")
file_names <- list.files()
ibuttons <- data.frame()
for (i in 1:length(file_names)){
temp_data <- read_csv(file_names[i], skip = 14)
temp_data$info <- file_names[i]
ibuttons <- rbind(ibuttons, temp_data)
}
library(tidyverse)
library(lubridate)
for (i in 1:length(file_names)){
temp_data <- read_csv(file_names[i], skip = 14)
temp_data$info <- file_names[i]
ibuttons <- rbind(ibuttons, temp_data)
}
ibuttons$`Date/Time` <- as.character(ibuttons$`Date/Time`)
ibutton_dates <- ibuttons %>%
separate("Date/Time", into = c("date", "time", "am"), sep = " ") %>%
unite(time_12hr, time, am, sep = " ")
ibutton_dates$date <- as.Date(ibutton_dates$date, format = "%d/%m/%y")
ibutton_dates$time_24hr <- format(strptime(ibutton_dates$time_12hr, "%I:%M:%S %p"),  format="%H:%M:%S")
# extract block and tile info from file name
ibutton_data <- ibutton_dates %>%
select(-2, -3) %>%
unite(date_time, date, time_24hr, sep = " ") %>%
separate(info, into = c("tileno","timestamp"), sep = "_")
# and now split up the block and tile number
ibutton_data <- ibutton_data %>%
mutate(block = substr(ibutton_data$tileno, 1, 1),
number = substr(ibutton_data$tileno, 2, length(ibutton_data$tileno))) %>%
rename(temp = Value)
ibutton_data <- ibutton_data %>%
dplyr::select(-tileno, -timestamp)
ibutton_data$number <- as.integer(ibutton_data$tileno)
# convert the double-digit integers (e.g. 01) to regular numbers
# for rock temperature, preserve that identifier
for (i in 1:length(ibutton_data$number)){
if (is.na(ibutton_data$number[i])) {
ibutton_data$number[i] = "rock"
}
}
ibutton_data <- ibutton_data %>%
dplyr::select(-tileno)
surveys <- read_csv("surveys.csv")
setwd("./")
getwd
getwd()
setwd("../")
surveys <- read_csv("surveys.csv")
getwd()
getwd()
setwd("./data")
surveys <- read_csv("surveys.csv")
glimpse(surveys)
surveys <- read_csv("surveys.csv") %>%
select(-X8)
glimpse(surveys)
block_design <- read_csv("moving_guide.csv")
